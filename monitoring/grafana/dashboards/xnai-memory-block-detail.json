{
  "uid": "xnai-memory-block-detail",
  "title": "XNAi Memory Bank - Block Detail",
  "tags": ["xnai", "memory-bank", "drilldown"],
  "timezone": "browser",
  "refresh": "30s",
  "time": {"from": "now-24h", "to": "now"},
  "panels": [
    {
      "id": 1,
      "title": "Block Utilization",
      "type": "stat",
      "gridPos": {"h": 4, "w": 8, "x": 0, "y": 0},
      "targets": [{"expr": "memory_block_utilization{block=\"$block\"}", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "percentunit", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": 0}, {"color": "yellow", "value": 0.7}, {"color": "red", "value": 0.9}]}}},
      "options": {"colorMode": "background"}
    },
    {
      "id": 2,
      "title": "Character Count",
      "type": "stat",
      "gridPos": {"h": 4, "w": 8, "x": 8, "y": 0},
      "targets": [{"expr": "memory_block_chars{block=\"$block\"}", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "short"}}
    },
    {
      "id": 3,
      "title": "Overflow Events (24h)",
      "type": "stat",
      "gridPos": {"h": 4, "w": 8, "x": 16, "y": 0},
      "targets": [{"expr": "increase(memory_overflow_events_total{block=\"$block\"}[24h])", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "short", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": 0}, {"color": "red", "value": 1}]}}}
    },
    {
      "id": 4,
      "title": "Utilization Trend",
      "type": "timeseries",
      "gridPos": {"h": 10, "w": 24, "x": 0, "y": 4},
      "targets": [{"expr": "memory_block_utilization{block=\"$block\"}", "legendFormat": "Utilization", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "percentunit", "min": 0, "max": 1, "custom": {"lineWidth": 3, "fillOpacity": 20}}}
    },
    {
      "id": 5,
      "title": "All Blocks by Tier",
      "type": "timeseries",
      "gridPos": {"h": 10, "w": 24, "x": 0, "y": 14},
      "targets": [{"expr": "memory_block_utilization{tier=\"$tier\"}", "legendFormat": "{{block}}", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "percentunit", "custom": {"lineWidth": 2, "fillOpacity": 5}}}
    }
  ],
  "templating": {
    "list": [
      {"name": "datasource", "type": "datasource", "query": "prometheus", "current": {"text": "VictoriaMetrics", "value": "VictoriaMetrics"}},
      {"name": "block", "type": "query", "query": "label_values(memory_block_utilization, block)", "refresh": 2, "sort": 1},
      {"name": "tier", "type": "query", "query": "label_values(memory_block_utilization, tier)", "refresh": 2, "sort": 1, "current": {"text": "core", "value": "core"}}
    ]
  }
}

# XNAi Security Checklist

> **Date**: 2026-02-23
> **Context**: JOB-W2-005 - Security Audit Research
> **Status**: INITIAL DRAFT

---

## üõ°Ô∏è LLM Security Checklist (OWASP-ALIGNED)

### 1. Prompt Injection (LLM01)
- [ ] Are all user inputs sanitized/validated before being added to a prompt?
- [ ] Is "Prompt Framing" used to explicitly separate user input from system instructions?
- [ ] Are the LLM's permissions restricted via `knowledge_access.py` to only the necessary resources?

### 2. Sensitive Information Disclosure (LLM02)
- [ ] Does all LLM output pass through `ContentSanitizer`?
- [ ] Are PII and secrets (API keys, passwords) redacted using the `sanitizer.py` regex/hash system?
- [ ] Is there a process for regular auditing of LLM outputs for "Gold Tier" documents?

### 3. Improper Output Handling (LLM05)
- [ ] Is LLM-generated code sanitized or executed in a secure sandbox?
- [ ] Does the UI (Chainlit) escape/sanitize Markdown/HTML generated by the LLM?

### 4. Excessive Agency (LLM06)
- [ ] Is the "Human-in-the-loop" pattern used for "Gold Tier" data writes?
- [ ] Are agent DIDs verified using Ed25519 signatures before performing tasks?
- [ ] Does the `KnowledgeAccessControl` system follow the principle of least privilege?

### 5. Vector & Embedding Weaknesses (LLM08)
- [ ] Is metadata-level access control (ABAC) enforced for all Qdrant queries?
- [ ] Are embeddings generated from a trusted, internally-hosted model (to avoid supply chain risks)?

### 6. Unbounded Consumption (LLM10)
- [ ] Is rate-limiting implemented for all knowledge access operations?
- [ ] Are there token limits enforced on LLM generation (max_tokens)?
- [ ] Are there timeouts for all external API calls and long-running research tasks?

---

## üìã Security Posture Scoring (XNAi Current)

| Category | Score (0-10) | Notes |
|----------|--------------|-------|
| Identity & Access | 9/10 | Ed25519 + ABAC is strong. |
| Sanitization | 7/10 | Regex is good, but lacks semantic check. |
| Prompt Protection | 4/10 | Needs more explicit "framing" in system prompts. |
| Resource Control | 5/10 | Rate-limiting is missing. |
| **TOTAL** | **6.25/10** | **Moderate Security Risk** |

---

## üöÄ Recommended Actions (Immediate)

1. **Add Rate Limiting**: Implement in `KnowledgeAccessControl.check_access`.
2. **Output Sanitization**: Mandate `sanitizer.py` for all outgoing agent responses.
3. **Prompt Framing**: Update `SYSTEM-INSTRUCTIONS.md` to use clear delimiters for user-provided data.
